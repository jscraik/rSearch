name: Changelog Check

on:
    pull_request:
        paths:
            - "src/**"
            - "package.json"

jobs:
    check-changelog:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4
              with:
                  fetch-depth: 0

            - name: Check if changelog needs update
              run: |
                  # Check if there are changes in src/ or package.json
                  if git diff --name-only origin/main...HEAD | grep -E "(src/|package\.json)"; then
                    echo "üìù Code changes detected, checking changelog..."
                    
                    # Check if CHANGELOG.md has been updated
                    if git diff --name-only origin/main...HEAD | grep -q "CHANGELOG.md"; then
                      echo "‚úÖ CHANGELOG.md has been updated"
                    else
                      echo "‚ö†Ô∏è  CHANGELOG.md should be updated for code changes"
                      echo ""
                      echo "Please add your changes to the [Unreleased] section in CHANGELOG.md"
                      echo "Categories: Added, Changed, Fixed"
                      echo ""
                      echo "This is a reminder, not a blocking check."
                    fi
                  else
                    echo "‚úÖ No code changes detected, changelog update not required"
                  fi
